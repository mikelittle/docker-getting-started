# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/config-gitpod-file)
# and commit this file to your remote git repository to share the goodness with others.
# image:
#   file: Dockerfile
# tasks:
#   - init: yarn install --production
#     command: yarn run dev
tasks:
  - before: >
        [[ ! -z $SIGNING_KEY  ]] &&
        gpg --verbose --batch --import <(echo $SIGNING_KEY|base64 -d) &&
        echo 'pinentry-mode loopback' >> ~/.gnupg/gpg.conf &&
        git config --global user.signingkey $SIGNING_KEY_ID &&
        git config --global user.email $SIGNING_EMAIL &&
        git config --global commit.gpgsign true &&
        mkdir -p ~/.ssh &&
        printf %s "$GITPOD4GITPUB_KEY" | base64 -d > ~/.ssh/id_rsa &&
        chmod 600 ~/.ssh/id_rsa &&
        SSHKey=$(ssh-keyscan git.pub 2> /dev/null) &&
        echo "$SSHKey" >> ~/.ssh/known_hosts &&
        if ssh-add -l > /dev/null ; then eval "$(ssh-agent -s)" > /dev/null ; ssh-add -q ~/.ssh/id_rsa ; fi

